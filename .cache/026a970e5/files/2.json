{"contents":"exports.__esModule = true;\nvar utils_1 = __fusereq(3);\nclass Presenter {\n  constructor(roomId, rec, roomKey) {\n    this.mensajes = {};\n    this.queue = [];\n    this.raw = \"\";\n    this.stoped = false;\n    this.listennerMode = true;\n    this.elements = {};\n    this.__title = \"\";\n    var div = utils_1.createDiv({\n      width: \"100%\",\n      height: \"100%\"\n    });\n    div.className = \"msgContainner\";\n    div.id = \"core\";\n    var header = utils_1.createDiv(\"header\");\n    div.append(header);\n    let title = utils_1.createElement(\"h2\", {\n      margin: \"15px 0\"\n    });\n    title.innerHTML = ``;\n    header.append(title);\n    this.elements.title = title;\n    let roomData = utils_1.createDiv({\n      margin: \"15px 0\"\n    });\n    roomData.innerHTML = `Id de la sala: ${roomId}`;\n    let svg = utils_1.createElement(\"img\", {\n      paddingLeft: 10\n    });\n    svg.classList.add(\"fullscreen\");\n    svg.src = \"/images/fullscreen.svg\";\n    svg.onclick = () => {\n      document.documentElement.requestFullscreen();\n    };\n    roomData.append(svg);\n    header.append(roomData);\n    this.elements.roomData = roomData;\n    let timeCounter = utils_1.createDiv({\n      margin: \"15px 0\",\n      fontSize: 30,\n      fontWeight: 600\n    });\n    timeCounter.innerHTML = ``;\n    header.append(timeCounter);\n    this.elements.timeCounter = timeCounter;\n    if (rec) this.listennerMode = false;\n    this.control = utils_1.createDiv(\"navigation\");\n    var stopButton = utils_1.createElement(\"button\");\n    stopButton.innerHTML = \"STOP\";\n    stopButton.onclick = () => {\n      if (this.stoped && this.listennerMode) {\n        stopButton.classList.remove(\"disabled\");\n        stopButton.innerHTML = \"STOP\";\n        this.stoped = false;\n      } else {\n        stopButton.classList.add(\"disabled\");\n        stopButton.innerHTML = \"RESTART\";\n        this.stoped = true;\n      }\n      if (rec) {\n        console.log(\"STOP RECORDER\", rec);\n        rec.stop();\n        var irAlEditor = utils_1.createElement(\"button\");\n        irAlEditor.innerHTML = \"Ir al editor\";\n        irAlEditor.onclick = () => {\n          location.href = `/editor/${roomKey}`;\n        };\n        this.control.append(irAlEditor);\n      }\n    };\n    this.control.append(stopButton);\n    div.append(this.control);\n    this.transmissionContainner = utils_1.createDiv(\"transcripciones\", {\n      width: 400,\n      maxHeight: 200,\n      margin: \"auto auto\",\n      color: \"#ffffff\",\n      fontSize: 20,\n      display: \"flex\",\n      flexDirection: \"column\",\n      overflow: \"hidden\"\n    });\n    this.transmissionContainner.style.scrollBehavior = \"smooth\";\n    div.append(this.transmissionContainner);\n    document.body.append(div);\n  }\n  set title(value) {\n    this.__title = value;\n    this.elements.title.innerHTML = value;\n  }\n  set timeElapsed(value) {\n    this.elements.timeCounter.innerHTML = (value / 1000 | 0).toString();\n  }\n  render() {\n    if (this.listennerMode == true && this.stoped) return;\n    while (this.queue.length) {\n      var mensaje = this.queue.splice(0, 1)[0];\n      console.log(mensaje, this.queue);\n      if (!this.mensajes[mensaje.id]) {\n        var div = utils_1.createDiv(\"textRow\", {\n          marginRight: \"4pt\"\n        });\n        this.transmissionContainner.append(div);\n        this.mensajes[mensaje.id] = div;\n        this.mensajes[mensaje.id].innerHTML = mensaje.result;\n        this.transmissionContainner.scrollTo({\n          top: this.transmissionContainner.scrollHeight\n        });\n      } else {\n        this.mensajes[mensaje.id].innerHTML = mensaje.result;\n        this.transmissionContainner.scrollTo({\n          top: this.transmissionContainner.scrollHeight\n        });\n      }\n    }\n  }\n  append(data) {\n    if (data) {\n      this.queue.push(data);\n      this.render();\n    } else {\n      console.error(\"Append null\");\n    }\n  }\n  stop() {\n    this.stoped = true;\n  }\n  resume() {\n    this.stoped = false;\n    this.render();\n  }\n}\nexports.Presenter = Presenter;\n","sourceMap":"{\"version\":3,\"sources\":[\"public/src/presenter.ts\"],\"names\":[\"constructor\",\"roomId\",\"rec\",\"roomKey\",\"mensajes\",\"queue\",\"raw\",\"stoped\",\"listennerMode\",\"elements\",\"__title\",\"div\",\"utils_1\",\"width\",\"height\",\"className\",\"id\",\"header\",\"append\",\"title\",\"margin\",\"innerHTML\",\"roomData\",\"svg\",\"paddingLeft\",\"classList\",\"add\",\"src\",\"onclick\",\"document\",\"documentElement\",\"requestFullscreen\",\"timeCounter\",\"fontSize\",\"fontWeight\",\"control\",\"stopButton\",\"remove\",\"console\",\"log\",\"stop\",\"irAlEditor\",\"location\",\"href\",\"transmissionContainner\",\"maxHeight\",\"color\",\"display\",\"flexDirection\",\"overflow\",\"style\",\"scrollBehavior\",\"body\",\"value\",\"timeElapsed\",\"toString\",\"render\",\"length\",\"mensaje\",\"splice\",\"marginRight\",\"result\",\"scrollTo\",\"top\",\"scrollHeight\",\"data\",\"push\",\"error\",\"resume\"],\"mappings\":\";;AAGO;EAYHA,YAAaC,QAAgBC,KAAMC;SATnCC;SACAC;SACAC,MAAc;SACdC,SAAkB;SAClBC,gBAAyB;SAEzBC;SAEQC,UAAU;QAEVC,MAAMC;MAAWC,OAAO;MAAQC,QAAQ;;IAC5CH,IAAII,YAAU;IACdJ,IAAIK,KAAK;QAELC,SAASL,kBAAU;IACvBD,IAAIO,OAAOD;QAEPE,QAAQP,sBAAc;MAAOQ,QAAQ;;IACzCD,MAAME;IACNJ,OAAOC,OAAOC;IACd,KAAKV,SAASU,QAAQA;QAElBG,WAAWV;MAAWQ,QAAQ;;IAClCE,SAASD,8BAA8BpB;QACnCsB,MAAMX,sBAAc;MAASY,aAAa;;IAC9CD,IAAIE,UAAUC,IAAI;IAClBH,IAAII,MAAM;IACVJ,IAAIK,UAAU;MACVC,SAASC,gBAAgBC;;IAE7BT,SAASJ,OAAOK;IAChBN,OAAOC,OAAOI;IACd,KAAKb,SAASa,WAAWA;QAErBU,cAAcpB;MAAWQ,QAAQ;MAAUa,UAAU;MAAIC,YAAY;;IACzEF,YAAYX;IACZJ,OAAOC,OAAOc;IACd,KAAKvB,SAASuB,cAAcA;QAGxB9B,KAAK,KAAKM,gBAAgB;IAE9B,KAAK2B,UAAUvB,kBAAU;QACrBwB,aAAaxB,sBAAc;IAC/BwB,WAAWf,YAAY;IACvBe,WAAWR,UAAU;UACb,KAAKrB,UAAU,KAAKC;QACpB4B,WAAWX,UAAUY,OAAO;QAC5BD,WAAWf,YAAY;QACvB,KAAKd,SAAS;;QAEd6B,WAAWX,UAAUC,IAAI;QACzBU,WAAWf,YAAY;QACvB,KAAKd,SAAS;;UAGfL;QACCoC,QAAQC,IAAI,iBAAiBrC;QAC7BA,IAAIsC;YAEAC,aAAa7B,sBAAc;QAC/B6B,WAAWpB,YAAY;QACvBoB,WAAWb,UAAU;UACjBc,SAASC,kBAAkBxC;;QAE/B,KAAKgC,QAAQjB,OAAOuB;;;IAG5B,KAAKN,QAAQjB,OAAOkB;IAKpBzB,IAAIO,OAAO,KAAKiB;IAEhB,KAAKS,yBAAyBhC,kBAAU;MAAoBC,OAAO;MAAKgC,WAAW;MAAMzB,QAAQ;MAAa0B,OAAO;MAAWb,UAAU;MAC1Ic,SAAS;MAAQC,eAAe;MAAUC,UAAU;;IACpD,KAAKL,uBAAuBM,MAAMC,iBAAiB;IACnDxC,IAAIO,OAAO,KAAK0B;IAEhBf,SAASuB,KAAKlC,OAAOP;;MAGrBQ,MAAMkC;IACN,KAAK3C,UAAU2C;IACf,KAAK5C,SAASU,MAAME,YAAYgC;;MAEhCC,YAAYD;IACZ,KAAK5C,SAASuB,YAAYX,aAAagC,QAAQ,OAAO,GAAGE;;EAGrDC;QACA,KAAKhD,iBAAiB,QAAQ,KAAKD;WACjC,KAAKF,MAAMoD;UAETC,UAAU,KAAKrD,MAAMsD,OAAO,GAAG,GAAG;MACtCrB,QAAQC,IAAImB,SAAS,KAAKrD;WACrB,KAAKD,SAASsD,QAAQ1C;YACnBL,MAAMC,kBAAU;UAAYgD,aAAa;;QAC7C,KAAKhB,uBAAuB1B,OAAOP;QACnC,KAAKP,SAASsD,QAAQ1C,MAAML;QAC5B,KAAKP,SAASsD,QAAQ1C,IAAIK,YAAYqC,QAAQG;QAC9C,KAAKjB,uBAAuBkB;UAAUC,KAAK,KAAKnB,uBAAuBoB;;;QAEvE,KAAK5D,SAASsD,QAAQ1C,IAAIK,YAAYqC,QAAQG;QAC9C,KAAKjB,uBAAuBkB;UAAUC,KAAK,KAAKnB,uBAAuBoB;;;;;EAKnF9C,OAAO+C;QACCA;MACA,KAAK5D,MAAM6D,KAAKD;MAChB,KAAKT;;MAELlB,QAAQ6B,MAAM;;;EAItB3B;IACI,KAAKjC,SAAS;;EAElB6D;IACI,KAAK7D,SAAS;IACd,KAAKiD\",\"sourcesContent\":[\"import { createDiv, createElement } from \\\"./components/utils\\\"\\r\\n\\r\\n\\r\\nexport class Presenter {\\r\\n    transmissionContainner: HTMLDivElement;\\r\\n    control: HTMLDivElement;\\r\\n    mensajes: {[id: string]: HTMLDivElement} = {}\\r\\n    queue: {result: string, id: string}[] = []\\r\\n    raw: string = \\\"\\\"\\r\\n    stoped: boolean = false;\\r\\n    listennerMode: boolean = true;\\r\\n\\r\\n    elements: {title?: HTMLElement, roomData?: HTMLElement, timeCounter?: HTMLElement} = {}\\r\\n\\r\\n    private __title = \\\"\\\";\\r\\n    constructor( roomId: string, rec?, roomKey?: string) {\\r\\n        var div = createDiv({width: \\\"100%\\\", height: \\\"100%\\\"})\\r\\n        div.className=\\\"msgContainner\\\";\\r\\n        div.id = \\\"core\\\"\\r\\n\\r\\n        var header = createDiv(\\\"header\\\")\\r\\n        div.append(header)\\r\\n\\r\\n        let title = createElement(\\\"h2\\\", {margin: \\\"15px 0\\\"})\\r\\n        title.innerHTML = ``;       \\r\\n        header.append(title)\\r\\n        this.elements.title = title;\\r\\n\\r\\n        let roomData = createDiv({margin: \\\"15px 0\\\"})\\r\\n        roomData.innerHTML = `Id de la sala: ${roomId}`;  \\r\\n        let svg = createElement(\\\"img\\\",  {paddingLeft: 10}) as HTMLImageElement;\\r\\n        svg.classList.add(\\\"fullscreen\\\")\\r\\n        svg.src = \\\"/images/fullscreen.svg\\\";\\r\\n        svg.onclick = () => {\\r\\n            document.documentElement.requestFullscreen()\\r\\n        }\\r\\n        roomData.append(svg)     \\r\\n        header.append(roomData)\\r\\n        this.elements.roomData = roomData;\\r\\n\\r\\n        let timeCounter = createDiv({margin: \\\"15px 0\\\", fontSize: 30, fontWeight: 600})\\r\\n        timeCounter.innerHTML = ``;       \\r\\n        header.append(timeCounter)\\r\\n        this.elements.timeCounter = timeCounter;\\r\\n\\r\\n\\r\\n        if (rec) this.listennerMode = false;\\r\\n\\r\\n        this.control = createDiv(\\\"navigation\\\")\\r\\n        var stopButton = createElement(\\\"button\\\")\\r\\n        stopButton.innerHTML = \\\"STOP\\\"\\r\\n        stopButton.onclick = () => {\\r\\n            if (this.stoped && this.listennerMode) {\\r\\n                stopButton.classList.remove(\\\"disabled\\\")\\r\\n                stopButton.innerHTML = \\\"STOP\\\"\\r\\n                this.stoped = false;\\r\\n            } else {\\r\\n                stopButton.classList.add(\\\"disabled\\\")\\r\\n                stopButton.innerHTML = \\\"RESTART\\\"\\r\\n                this.stoped = true;\\r\\n            }\\r\\n           \\r\\n            if(rec) {\\r\\n                console.log(\\\"STOP RECORDER\\\", rec);\\r\\n                rec.stop();\\r\\n\\r\\n                var irAlEditor = createElement(\\\"button\\\");\\r\\n                irAlEditor.innerHTML = \\\"Ir al editor\\\";\\r\\n                irAlEditor.onclick = () => {\\r\\n                    location.href = `/editor/${roomKey}`;\\r\\n                }\\r\\n                this.control.append(irAlEditor);\\r\\n            }\\r\\n        }\\r\\n        this.control.append(stopButton)\\r\\n\\r\\n        \\r\\n\\r\\n\\r\\n        div.append(this.control)\\r\\n\\r\\n        this.transmissionContainner = createDiv(\\\"transcripciones\\\", {width: 400, maxHeight: 200,  margin: \\\"auto auto\\\", color: \\\"#ffffff\\\", fontSize: 20, \\r\\n        display: \\\"flex\\\", flexDirection: \\\"column\\\", overflow: \\\"hidden\\\"})\\r\\n        this.transmissionContainner.style.scrollBehavior = \\\"smooth\\\";\\r\\n        div.append(this.transmissionContainner)\\r\\n\\r\\n        document.body.append(div)\\r\\n    }\\r\\n\\r\\n    set title(value: string) {\\r\\n        this.__title = value;\\r\\n        this.elements.title.innerHTML = value;\\r\\n    }\\r\\n    set timeElapsed(value: number) {\\r\\n        this.elements.timeCounter.innerHTML = (value / 1000 | 0).toString();\\r\\n    }\\r\\n\\r\\n    private render() {\\r\\n        if (this.listennerMode == true && this.stoped) return;\\r\\n        while(this.queue.length) {\\r\\n        \\r\\n            var mensaje = this.queue.splice(0, 1)[0];\\r\\n            console.log(mensaje, this.queue)\\r\\n            if (!this.mensajes[mensaje.id]) {\\r\\n                var div = createDiv(\\\"textRow\\\",{ marginRight: \\\"4pt\\\"});\\r\\n                this.transmissionContainner.append(div);\\r\\n                this.mensajes[mensaje.id] = div;\\r\\n                this.mensajes[mensaje.id].innerHTML = mensaje.result;\\r\\n                this.transmissionContainner.scrollTo({top: this.transmissionContainner.scrollHeight})\\r\\n            } else {\\r\\n                this.mensajes[mensaje.id].innerHTML = mensaje.result;\\r\\n                this.transmissionContainner.scrollTo({top: this.transmissionContainner.scrollHeight})\\r\\n            }\\r\\n        }\\r\\n     \\r\\n    }\\r\\n    append(data: {result: string, id: string}) {\\r\\n        if (data) {\\r\\n            this.queue.push(data)   \\r\\n            this.render();  \\r\\n        } else {\\r\\n            console.error(\\\"Append null\\\")\\r\\n        }\\r\\n\\r\\n    }\\r\\n    stop() {\\r\\n        this.stoped = true;\\r\\n    }\\r\\n    resume() {\\r\\n        this.stoped = false;\\r\\n        this.render();\\r\\n    }\\r\\n}\\r\\n\"]}"}